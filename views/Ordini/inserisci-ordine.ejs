<%- contentFor('HeaderCss') %>
<!-- DataTables -->
<link href="public/assets/libs/datatables.net-bs4/css/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css" />
<link href="public/assets/libs/datatables.net-buttons-bs4/css/buttons.bootstrap4.min.css" rel="stylesheet" type="text/css" />

<!-- Responsive datatable examples -->
<link href="public/assets/libs/datatables.net-responsive-bs4/css/responsive.bootstrap4.min.css" rel="stylesheet" type="text/css" />  
<%- contentFor('breadcrumb') %>

<!-- start page title -->
<div class="row">
    <div class="col-12">
        <div class="page-title-box d-flex align-items-center justify-content-between">
            <h4 class="mb-0">Ordini</h4>

            <div class="page-title-right">
                <ol class="breadcrumb m-0">
                    <li class="breadcrumb-item"><a href="/lista-ordini">Lista Ordini</a></li>
                    <li class="breadcrumb-item active">Inserisci Ordine</li>
                </ol>
            </div>

        </div>
    </div>
</div>
<!-- end page title -->

<%- contentFor('body') %>
 <!-- Full screen modal --> 
<div id="exampleModalFullscreen" class="modal fade" tabindex="-1"  aria-labelledby="#exampleModalFullscreenLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title mt-0" id="exampleModalFullscreenLabel">Clienti</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="table-responsive mb-4">
                    <table id="datatable-buttons" class="table table-centered datatable nowrap mb-0 table-card-list tabClienti">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Cognome</th>
                                <th>Partita iva</th>
                                <th>Email</th>
                            </tr>
                        </thead>
                        <tbody id="modal-body">
                                
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="buttonOk" class="btn btn-light waves-effect" data-bs-dismiss="modal">Ok</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<div class="row">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title mb-4">Inserisci Ordine</h4>

                <div id="basic-example">
                    <!-- Seller Details -->
                    <h3>Dati Cliente</h3>
                    <section>
                        <form>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label for="basicpill-firstname-input">Nome</label>
                                        <input type="text" class="form-control" id="basicpill-firstname-input" onclick="fetchDataFromMongoDB()" data-bs-toggle="modal" data-bs-target="#exampleModalFullscreen">
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label for="basicpill-lastname-input">Cognome</label>
                                        <input type="text" class="form-control" id="basicpill-lastname-input">
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label for="basicpill-phoneno-input">Telefono</label>
                                        <input type="text" class="form-control" id="basicpill-phoneno-input">
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label for="basicpill-email-input">Email</label>
                                        <input type="email" class="form-control" id="basicpill-email-input">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label for="basicpill-address-input">Indirizzo</label>
                                        <input type="text" class="form-control" id="basicpill-address-input">
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label for="basicpill-citta-input">Città</label>
                                        <input type="text" class="form-control" id="basicpill-citta-input">
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label for="basicpill-cap-input">Cap</label>
                                        <input type="text" class="form-control" id="basicpill-cap-input">
                                    </div>
                                </div>
                            </div>
                        </form>
                    </section>

                    <!-- Company Document -->
                    <h3>Company Document</h3>
                    <section>
                        <form>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label for="basicpill-pancard-input">PAN Card</label>
                                        <input type="text" class="form-control" id="basicpill-pancard-input">
                                    </div>
                                </div>

                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label for="basicpill-vatno-input">VAT/TIN No.</label>
                                        <input type="text" class="form-control" id="basicpill-vatno-input">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label for="basicpill-cstno-input">CST No.</label>
                                        <input type="text" class="form-control" id="basicpill-cstno-input">
                                    </div>
                                </div>

                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label for="basicpill-servicetax-input">Service Tax No.</label>
                                        <input type="text" class="form-control" id="basicpill-servicetax-input">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label for="basicpill-companyuin-input">Company UIN</label>
                                        <input type="text" class="form-control" id="basicpill-companyuin-input">
                                    </div>
                                </div>

                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label for="basicpill-declaration-input">Declaration</label>
                                        <input type="text" class="form-control" id="basicpill-Declaration-input">
                                    </div>
                                </div>
                            </div>
                        </form>
                    </section>

                    <!-- Bank Details -->
                    <h3>Bank Details</h3>
                    <section>
                        <div>
                            <form>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label for="basicpill-namecard-input">Name on Card</label>
                                            <input type="text" class="form-control" id="basicpill-namecard-input">
                                        </div>
                                    </div>

                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label>Credit Card Type</label>
                                            <select class="form-select">
                                                  <option selected>Select Card Type</option>
                                                  <option value="AE">American Express</option>
                                                  <option value="VI">Visa</option>
                                                  <option value="MC">MasterCard</option>
                                                  <option value="DI">Discover</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label for="basicpill-cardno-input">Credit Card Number</label>
                                            <input type="text" class="form-control" id="basicpill-cardno-input">
                                        </div>
                                    </div>

                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label for="basicpill-card-verification-input">Card Verification Number</label>
                                            <input type="text" class="form-control" id="basicpill-card-verification-input">
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label for="basicpill-expiration-input">Expiration Date</label>
                                            <input type="text" class="form-control" id="basicpill-expiration-input">
                                        </div>
                                    </div>

                                </div>
                            </form>
                          </div>
                    </section>

                    <!-- Confirm Details -->
                    <h3>Confirm Detail</h3>
                    <section>
                        <div class="row justify-content-center">
                            <div class="col-lg-6">
                                <div class="text-center">
                                    <div class="mb-4">
                                        <i class="mdi mdi-check-circle-outline text-success display-4"></i>
                                    </div>
                                    <div>
                                        <h5>Confirm Detail</h5>
                                        <p class="text-muted">If several languages coalesce, the grammar of the resulting</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>

            </div>
            <!-- end card body -->
        </div>
        <!-- end card -->
    </div>
    <!-- end col -->

</div>
<!-- end row -->

<%- contentFor('FooterJs') %>
<script>
    async function fetchDataFromMongoDB() {
        await fetch(`/lista-clienti-fetch`)
       .then(function(res){
           return res.json();
       })
       .then(function(utente){
           // Rimuovi tutte le righe esistenti
           var table = $('#datatable-buttons').DataTable();
            table.clear().draw();
           // Aggiungi nuove righe (esempio)
           var newData = [];
           utente.forEach(item => {
            var dati = [item.nome, item.cognome, item.piva, item.email];
            newData.push(dati);
                })
            table.rows.add(newData).draw();
            // Gestisci l'evento di clic sulla riga
            $('#datatable-buttons tbody').on('click', 'tr', function () {
                // Ottieni i dati della riga cliccata
                var data = table.row(this).data();

                // Estrai il contenuto della colonna "Nome"
                var nome = data[0]; // La colonna "Nome" è la prima (indice 0)
                var cognome = data[1]; // La colonna "Nome" è la prima (indice 0)
                var telefono = '';
                var indirizzo = data[2]; // La colonna "Nome" è la prima (indice 0)
                var citta = data[3]; // La colonna "Nome" è la prima (indice 0)
                var cap = data[4]; // La colonna "Nome" è la prima (indice 0)
                var email = data[5]; // La colonna "Nome" è la prima (indice 0)

                // Fai qualcosa con il valore del nome, ad esempio, mostra in console

                // Ottieni il riferimento al pulsante con l'ID "buttonOk"
                var buttonOk = document.getElementById("buttonOk");

                // Simula il clic sul pulsante
                if (buttonOk) {
                    // Ottieni il riferimento all'elemento di input
                    var inputElementfirstname = document.getElementById("basicpill-firstname-input");
                    var inputElementlastname = document.getElementById("basicpill-lastname-input");
                    var inputElementphoneno = document.getElementById("basicpill-phoneno-input");
                    var inputElementemail = document.getElementById("basicpill-email-input");
                    var inputElementaddress = document.getElementById("basicpill-address-input");
                    var inputElementcitta = document.getElementById("basicpill-citta-input");
                    var inputElementcap = document.getElementById("basicpill-cap-input");

                    // Imposta il nuovo valore dell'input
                    if (inputElementfirstname) {
                        inputElementfirstname.value = nome;
                    }
                    if (inputElementlastname) {
                        inputElementlastname.value = cognome;
                    }
                    if (inputElementphoneno) {
                        inputElementphoneno.value = telefono;
                    }
                    if (inputElementemail) {
                        inputElementemail.value = email;
                    }
                    if (inputElementaddress) {
                        inputElementaddress.value = indirizzo;
                    }
                    if (inputElementcitta) {
                        inputElementcitta.value = citta;
                    }
                    if (inputElementcap) {
                        inputElementcap.value = cap;
                    }
                    buttonOk.click();
                }
            });
       })
   }
 </script>

<!-- jquery step -->
<script src="public/assets/libs/jquery-steps/build/jquery.steps.min.js"></script>
<!-- Required datatable js -->
<script src="public/assets/libs/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="public/assets/libs/datatables.net-bs4/js/dataTables.bootstrap4.min.js"></script>

<!-- Buttons examples -->
<script src="public/assets/libs/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
<script src="public/assets/libs/datatables.net-buttons-bs4/js/buttons.bootstrap4.min.js"></script>
<script src="public/assets/libs/jszip/jszip.min.js"></script>
<script src="public/assets/libs/pdfmake/build/pdfmake.min.js"></script>
<script src="public/assets/libs/pdfmake/build/vfs_fonts.js"></script>
<script src="public/assets/libs/datatables.net-buttons/js/buttons.html5.min.js"></script>
<script src="public/assets/libs/datatables.net-buttons/js/buttons.print.min.js"></script>
<script src="public/assets/libs/datatables.net-buttons/js/buttons.colVis.min.js"></script>

<!-- Responsive examples -->
<script src="public/assets/libs/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
<script src="public/assets/libs/datatables.net-responsive-bs4/js/responsive.bootstrap4.min.js"></script>
<!-- form wizard init -->
<script src="public/assets/js/pages/form-wizard.init.js"></script>
<!-- init js -->
<script src="public/assets/js/pages/ordini-inserisci.js"></script>


<%- contentFor('BottomJs') %>